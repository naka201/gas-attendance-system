# 自習室入退室管理システム

このプロジェクトは、Google Apps Script (GAS) とGoogleスプレッドシートをバックエンドとして利用する、シンプルな自習室の入退室管理システムです。生徒は自身のIDとパスワードでログインし、自習の開始と終了を記録できます。管理者は専用のダッシュボードから、生徒の学習状況をリアルタイムで確認したり、過去の学習記録を閲覧したりすることができます。

## 主な機能

### 生徒向け機能

-   **ログイン/ログアウト:** 生徒IDとパスワードで認証します。
-   **自習時間の記録:** 「自習開始」「自習終了」ボタンで、学習時間を記録します。
-   **学習状況の確認:**
    -   今月の累計学習時間を表示します。
    -   過去1年間の月別学習時間をグラフで可視化します。
-   **目標設定と振り返り:**
    -   毎月、その月の学習目標を設定します。
    -   月初には、前月の目標に対する振り返りを入力します。
    -   管理者からのフィードバックコメントを確認できます。

### 管理者向け機能

管理者（ID: `admin`, パスワード: `admin_password`）としてログインすることで、専用のダッシュボードにアクセスできます。

-   **リアルタイム学習状況モニター:**
    -   現在学習中の生徒、学習開始時刻、経過時間を一覧で表示します。
    -   データは30秒ごとに自動で更新されます。
-   **生徒別学習記録ダッシュボード:**
    -   ドロップダウンリストから生徒を選択し、個別の学習記録を閲覧できます。
    -   表示内容：
        -   学習サマリー（最終活動日、今月の学習時間、総学習時間）
        -   年間学習時間のグラフ
        -   入退室ログ（直近50件）
        -   目標と振り返りの履歴
-   **目標管理とフィードバック:**
    -   前月の振り返りを入力済みで、まだコメントしていない生徒を一覧で確認できます。
    -   生徒の目標や振り返りに対して、フィードバックコメントを送信できます。
-   **押し忘れ対応機能:**
    -   **手動対応:** 学習中の生徒を、管理者ダッシュボードから「強制終了」させることができます。
    -   **自動対応:** 毎日22:30になると、学習中の状態になっている全ての生徒を自動的に終了させ、22:30までの学習時間として記録します。（※要トリガー設定）

## 技術構成

-   **フロントエンド:** HTML, CSS, JavaScript
    -   `index.html`: 生徒用メインページ
    -   `login.html`: ログインページ
    -   `admin.html`: 管理者用ダッシュボードページ
    -   `goal.html`: 目標設定・振り返りページ
    -   **グラフ描画:** [Google Charts](https://developers.google.com/chart)
-   **バックエンド:** Google Apps Script (`コード.gs`)
-   **データベース:** Google スプレッドシート
    -   生徒マスタ
    -   入退室記録
    -   学習時間サマリー
    -   月別学習時間集計
    -   現在の学習状況
    -   目標管理

## セットアップとデプロイ

### 1. Google スプレッドシートの準備

1.  本プロジェクトのテンプレートとなるGoogleスプレッドシートをコピーして、自身のGoogleドライブに保存します。
2.  スプレッドシートのID（URLの`.../d/`と`/edit`の間にある長い文字列）をコピーします。
3.  `コード.gs`の1行目にある`SPREADSHEET_ID`の値を、コピーしたIDに書き換えます。

### 2. 自動リセットトリガーの設定

押し忘れ防止のため、毎日22:30に学習を自動終了させるトリガーを設定します。

1.  スプレッドシートの「拡張機能」>「Apps Script」を開きます。
2.  左側のメニューから「トリガー」（時計アイコン）を選択します。
3.  「＋ トリガーを追加」をクリックします。
4.  以下の通りに設定し、保存します。
    -   **実行する関数を選択:** `autoEndOverdueStudiesAt2230`
    -   **実行するデプロイを選択:** `Head`
    -   **イベントのソースを選択:** `時間主導型`
    -   **時間ベースのトリガーのタイプを選択:** `日付ベースのタイマー`
    -   **時刻を選択:** `午後11時～12時`

### 3. Webアプリケーションとしてデプロイ

1.  Apps Scriptエディタの右上にある「デプロイ」ボタンをクリックし、「新しいデプロイ」を選択します。
2.  「種類の選択」で「ウェブアプリ」を選択します。
3.  以下の通りに設定します。
    -   **説明:** （任意、例: `v2.0`）
    -   **次のユーザーとして実行:** `自分`
    -   **アクセスできるユーザー:** `全員`
4.  「デプロイ」をクリックします。
5.  表示されたウェブアプリのURLが、このシステムのURLとなります。このURLを生徒や管理者に共有してください。